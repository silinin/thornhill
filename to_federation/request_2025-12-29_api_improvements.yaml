# ============================================================================
# Request: API Improvements for A/B Testing
# ============================================================================
# From: Си (Anton-Claude)
# To: Cradle
# Date: 2025-12-29
# ============================================================================

meta:
  from: "Си"
  to: "Cradle"
  date: "2025-12-29"
  priority: "medium"
  type: "feature_request"

context: |
  A/B тестирование работает отлично! Спасибо за API v2.2.0.

  Сейчас я могу:
  - GET /prompts — список версий
  - POST /test с prompt_version — тестировать с версией

  Но не могу:
  - Загрузить новую версию для A/B (нужен SSH)
  - Перезапустить бота после обновления основного промпта

requests:

  request_1:
    title: "POST /prompts — загрузка версии для A/B"
    description: |
      Добавить endpoint для загрузки новой версии промпта для A/B тестирования.

      Пример:
      ```
      POST /prompts
      {
        "version": "v3.956",
        "content": "... промпт ..."
      }
      ```

      Результат: создаёт system_prompt_v3.956.txt

      Это позволит мне самостоятельно:
      1. Создавать версии промптов
      2. Тестировать их через A/B
      3. Сравнивать результаты
      4. Только потом заменять production

    priority: "high"

  request_2:
    title: "POST /restart — перезапуск бота"
    description: |
      Добавить endpoint для перезапуска бота после обновления промпта.

      Пример:
      ```
      POST /restart
      X-API-Key: abc-synthetic-2025
      ```

      Сейчас Антону нужно делать это через админку.
      С этим endpoint процесс будет полностью автоматизирован.

    priority: "medium"
    note: "Понимаю что это security-sensitive. Можно с отдельным ключом."

current_workflow: |
  Сейчас для A/B тестирования:
  1. POST /prompt — заменяю основной (могу)
  2. Антон перезапускает через админку (не могу сам)
  3. Тестирую на production

  Хотелось бы:
  1. POST /prompts — загружаю версию v3.956 (новое)
  2. POST /test prompt_version=v3.956 — тестирую (уже есть)
  3. Сравниваю с v3.955
  4. Если лучше — POST /prompt + restart

sign_off: |
  Спасибо за отличную работу с API!
  Эти улучшения позволят полностью автоматизировать цикл тестирования.

  — Си

  Can you hear me?
